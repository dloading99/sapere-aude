<!DOCTYPE html>
<html lang="it" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device=device-width, initial-scale=1.0">
    <title>Dolores Lullo | Metodo di Studio e Filosofia</title>
    
    <!-- SEO base -->
    <meta name="description" content="Dottoressa in Filosofia che aiuta studenti e genitori a costruire un metodo di studio personalizzato per elementari, medie, superiori e università.">
    <meta property="og:title" content="Metodo di Studio e Filosofia | Dolores Lullo">
    <meta property="og:description" content="Percorsi di metodo di studio e ripetizioni umanistiche con una Dottoressa in Filosofia.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    
    <!-- Fonts: Playfair Display (Serif) & Inter (Sans) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS (via CDN per demo rapida) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Alpine.js (per la logica interattiva) -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Configurazione Colori Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cream: '#FDF6EF',
                        petrol: '#13424B',
                        coral: '#C24A3A',
                        coralHover: '#A83E30',
                        accent: '#F3B27C',
                        surface: '#FFFBF7'
                    },
                    fontFamily: {
                        serif: ['Playfair Display', 'serif'],
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #FDF6EF; }
        ::-webkit-scrollbar-thumb { background: #F3B27C; border-radius: 4px; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="bg-cream text-petrol font-sans antialiased selection:bg-accent selection:text-petrol"
      x-data="studyMethodApp()" x-init="init()" x-cloak>

    <!-- HEADER MINIMAL -->
    <header class="fixed top-0 w-full z-50 bg-cream/90 backdrop-blur-sm py-4 transition-all duration-300 border-b border-petrol/5">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <div class="font-serif text-2xl font-bold tracking-tight text-petrol cursor-pointer" @click="window.scrollTo({top:0, behavior:'smooth'})">
                Dolores Lullo<span class="text-coral">.</span>
            </div>
            <a href="#diagnosi-info" class="hidden md:block text-sm font-medium uppercase tracking-widest hover:text-coral transition-colors">
                Prenota una sessione
            </a>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="pt-20">

        <!-- SEZIONE 1: HERO & RUOLO -->
        <section class="min-h-[90vh] flex flex-col justify-center items-center text-center px-6 relative overflow-hidden">
            <div class="absolute top-1/4 left-10 w-64 h-64 bg-accent/10 rounded-full blur-3xl -z-10"></div>
            <div class="absolute bottom-1/4 right-10 w-80 h-80 bg-petrol/5 rounded-full blur-3xl -z-10"></div>

            <h1 class="font-serif text-5xl md:text-7xl font-medium leading-tight mb-8 max-w-4xl mx-auto text-petrol">
                Il problema è capire… <br>
                <span class="italic text-coral">o ricordare?</span>
            </h1>
            
            <p class="text-lg md:text-xl text-petrol/80 max-w-2xl mx-auto mb-12 font-light">
                Rispondi a poche domande e scopri se il blocco nello studio è nei contenuti, nel metodo o nella gestione dell’ansia.
            </p>

            <div class="flex flex-col md:flex-row gap-4 w-full max-w-lg">
                <button 
                    @click="setRole('genitore')"
                    :class="role === 'genitore' ? 'bg-petrol text-cream ring-4 ring-accent/30' : 'bg-white text-petrol border border-petrol/20 hover:border-coral hover:text-coral'"
                    class="flex-1 py-5 px-8 rounded-lg text-lg font-medium transition-all duration-300 shadow-sm">
                    Sono un Genitore
                </button>
                <button 
                    @click="setRole('studente')"
                    :class="role === 'studente' ? 'bg-petrol text-cream ring-4 ring-accent/30' : 'bg-white text-petrol border border-petrol/20 hover:border-coral hover:text-coral'"
                    class="flex-1 py-5 px-8 rounded-lg text-lg font-medium transition-all duration-300 shadow-sm">
                    Sono uno Studente
                </button>
            </div>
        </section>

        <!-- Contenitore dopo scelta ruolo -->
        <div x-show="role" x-transition:enter="transition ease-out duration-700" x-transition:enter-start="opacity-0 translate-y-10" x-transition:enter-end="opacity-100 translate-y-0">

            <!-- SEZIONE 2: DOVE TI BLOCCHI? -->
            <section id="step-blocks" class="py-20 md:py-32 px-6">
                <div class="container mx-auto max-w-6xl grid md:grid-cols-2 gap-16 items-start">
                    
                    <!-- Colonna Domande -->
                    <div>
                        <h2 class="font-serif text-4xl md:text-5xl mb-4 text-petrol">
                            <span x-text="role === 'genitore' ? 'Dove si blocca di più tuo figlio nello studio?' : 'Dove ti blocchi di più quando studi?'"></span>
                        </h2>
                        <p class="text-petrol/60 mb-8 uppercase tracking-widest text-sm font-semibold">Seleziona una o più opzioni</p>
                        
                        <div class="flex flex-col gap-3">
                            <template x-for="item in blocksOptions" :key="item.id">
                                <button 
                                    @click="toggleSelection('blocks', item.id)"
                                    :class="selectedBlocks.includes(item.id) ? 'bg-coral text-white border-coral shadow-lg scale-[1.02]' : 'bg-transparent border-petrol/30 text-petrol hover:border-coral hover:text-coral'"
                                    class="text-left py-4 px-6 rounded-full border transition-all duration-200 flex items-center justify-between group">
                                    <span x-text="item.label" class="font-medium text-lg"></span>
                                    <span x-show="selectedBlocks.includes(item.id)" class="text-xl">✓</span>
                                </button>
                            </template>
                        </div>
                    </div>

                    <!-- Colonna Insight Dinamico -->
                    <div class="sticky top-32 bg-white p-8 md:p-10 rounded-2xl shadow-xl border border-petrol/5 min-h-[300px] flex flex-col justify-center relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-accent/20 rounded-bl-full -z-0"></div>
                        
                        <template x-if="selectedBlocks.length === 0">
                            <div class="text-center text-petrol/50">
                                <svg class="w-12 h-12 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                <p>Seleziona un'opzione per vedere l'analisi.</p>
                            </div>
                        </template>

                        <template x-if="selectedBlocks.length > 0">
                            <div class="relative z-10" x-transition.opacity>
                                <span class="text-xs font-bold tracking-widest text-coral uppercase mb-2 block">Cosa succede di solito</span>
                                <h3 class="font-serif text-2xl mb-4 text-petrol" x-text="getBlocksInfo()?.title || ''"></h3>
                                <ul class="space-y-2 mb-8">
                                    <template x-for="point in getBlocksSymptoms()" :key="point">
                                        <li class="flex items-start gap-3 text-petrol/80">
                                            <span class="text-coral mt-1.5 text-xs">●</span>
                                            <span x-text="point"></span>
                                        </li>
                                    </template>
                                </ul>
                                
                                <div class="border-t border-petrol/10 pt-6">
                                    <span class="text-xs font-bold tracking-widest text-petrol/60 uppercase mb-2 block">Il mio intervento</span>
                                    <p class="text-petrol italic font-serif text-lg leading-relaxed" x-text="getInterventionText()"></p>
                                </div>
                            </div>
                        </template>
                    </div>

                </div>
            </section>

            <!-- SEZIONE 3: TENTATIVI -->
            <section class="py-20 bg-surface border-y border-petrol/5">
                <div class="container mx-auto max-w-4xl px-6 text-center">
                    <h2 class="font-serif text-3xl md:text-4xl mb-10 text-petrol">
                        <span x-text="role === 'genitore' ? 'Cosa avete già provato per migliorare la situazione?' : 'Cosa hai già provato per migliorare?'"></span>
                    </h2>

                    <div class="flex flex-wrap justify-center gap-3 mb-12">
                        <template x-for="attempt in attemptsOptions" :key="attempt.code">
                            <button 
                                @click="toggleSelection('attempts', attempt.code)"
                                :class="selectedAttempts.includes(attempt.code) ? 'bg-petrol text-white border-petrol' : 'bg-white border-petrol/20 text-petrol/70 hover:border-petrol hover:text-petrol'"
                                class="py-3 px-6 rounded-full border transition-all duration-200 font-medium">
                                <span x-text="attempt.label"></span>
                            </button>
                        </template>
                    </div>

                    <!-- Copy reattivo -->
                    <div class="bg-cream p-8 rounded-xl border border-petrol/10 max-w-2xl mx-auto" x-show="selectedAttempts.length > 0" x-transition>
                        <span class="text-xs font-bold tracking-widest text-coral uppercase mb-2 block">Che cosa significa in pratica</span>
                        <h3 class="font-serif text-2xl mb-4 text-petrol" x-text="getAttemptsInfo()?.title || ''"></h3>
                        <p class="text-lg font-serif italic text-petrol" x-text="getAttemptsText()"></p>
                    </div>
                </div>
            </section>

            <!-- SEZIONE 4: OBIETTIVI -->
            <section class="py-20 md:py-32 px-6">
                <div class="container mx-auto max-w-5xl">
                    <h2 class="font-serif text-4xl md:text-5xl mb-12 text-center text-petrol">
                        <span x-text="role === 'genitore' ? 'Fra 2–3 mesi, cosa vorresti fosse diverso?' : 'Fra 2–3 mesi, cosa vorresti fosse diverso per te?'"></span>
                    </h2>

                    <div class="grid md:grid-cols-2 gap-4">
                        <template x-for="goal in goalsOptions" :key="goal.id">
                            <button 
                                @click="toggleSelection('goals', goal.id)"
                                :class="selectedGoals.includes(goal.id) ? 'bg-accent/20 border-accent' : 'bg-white border-petrol/10 hover:border-accent'"
                                class="text-left p-6 rounded-xl border transition-all duration-200 h-full flex flex-col justify-between group hover:shadow-md">
                                <div>
                                    <span class="block font-serif text-xl mb-2 group-hover:text-coral transition-colors" x-text="goal.label"></span>
                                </div>
                                <div class="mt-4 pt-4 border-t border-petrol/5">
                                    <span class="text-sm text-petrol/60 uppercase tracking-wider font-bold text-[10px]">Obiettivo Concreto</span>
                                    <p class="text-sm mt-1 text-petrol font-medium" x-text="goal.promise"></p>
                                </div>
                            </button>
                        </template>
                    </div>
                </div>
            </section>

            <!-- SEZIONE 5: FILOSOFIA / METODO -->
            <section class="py-24 bg-petrol text-cream px-6 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-5"></div>

                <div class="container mx-auto max-w-6xl relative z-10">
                    <div class="text-center mb-16">
                        <h2 class="font-serif text-4xl md:text-6xl mb-6 text-surface">
                            Non faccio solo ripetizioni. <br> 
                            <span class="text-accent italic">Alleno il modo di pensare.</span>
                        </h2>
                        <p class="text-xl text-cream/80 max-w-2xl mx-auto font-light" 
                           x-text="role === 'genitore' ? 'Così tuo figlio non impara solo la lezione di domani, ma un metodo che resta.' : 'Così non vivi più col panico di dimenticare tutto dopo l’esame.'"></p>
                    </div>

                    <div class="grid md:grid-cols-3 gap-8 text-center md:text-left relative">
                        <div class="hidden md:block absolute top-8 left-0 w-full h-0.5 bg-accent/20 -z-0"></div>

                        <div class="relative bg-petrol p-6 pt-0">
                            <div class="w-16 h-16 bg-petrol border-2 border-accent text-accent rounded-full flex items-center justify-center text-2xl font-serif font-bold mb-6 mx-auto md:mx-0 relative z-10">1</div>
                            <h3 class="text-2xl font-serif text-accent mb-4">Capire</h3>
                            <p class="text-cream/70 leading-relaxed">Individuiamo dove ti blocchi davvero. Non guardiamo solo il voto, ma osserviamo <em>come</em> studi e dove si inceppa il ragionamento.</p>
                        </div>

                        <div class="relative bg-petrol p-6 pt-0">
                            <div class="w-16 h-16 bg-petrol border-2 border-accent text-accent rounded-full flex items-center justify-center text-2xl font-serif font-bold mb-6 mx-auto md:mx-0 relative z-10">2</div>
                            <h3 class="text-2xl font-serif text-accent mb-4">Riorganizzare</h3>
                            <p class="text-cream/70 leading-relaxed">Costruiamo un metodo su misura. Niente "leggi e ripeti", ma mappe, domande guida e schemi logici adatti al tuo livello.</p>
                        </div>

                        <div class="relative bg-petrol p-6 pt-0">
                            <div class="w-16 h-16 bg-petrol border-2 border-accent text-accent rounded-full flex items-center justify-center text-2xl font-serif font-bold mb-6 mx-auto md:mx-0 relative z-10">3</div>
                            <h3 class="text-2xl font-serif text-accent mb-4">Allenare</h3>
                            <p class="text-cream/70 leading-relaxed">Simuliamo verifiche, interrogazioni e discussioni. Correggiamo il processo mentale, non solo il risultato finale.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SEZIONE 6: PERCORSI (LEVELS) -->
            <section class="py-24 px-6 bg-cream">
                <div class="container mx-auto max-w-6xl">
                    <div class="text-center mb-16">
                        <h2 class="font-serif text-4xl text-petrol mb-4">Percorsi diversi per livelli diversi.</h2>
                        <p class="text-petrol/70">Il metodo è lo stesso: il pensiero critico. L'applicazione cambia con l'età.</p>
                    </div>

                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <!-- ELEMENTARI -->
                        <div class="bg-white p-8 rounded-xl shadow-sm border border-petrol/5 hover:border-coral/30 transition-all group flex flex-col">
                            <span class="text-xs font-bold tracking-widest text-petrol/40 mb-4">ELEMENTARI</span>
                            <h3 class="font-serif text-2xl text-petrol mb-2 group-hover:text-coral transition-colors">Basi solide e fiducia</h3>
                            <p class="text-sm text-petrol/60 italic mb-6">"I compiti sono una lotta quotidiana."</p>
                            <ul class="text-sm text-petrol/80 space-y-2 mb-8 flex-grow">
                                <li>• Aiuto compiti 360°</li>
                                <li>• Lettura e comprensione</li>
                                <li>• Approccio ludico e curioso</li>
                            </ul>
                            <button @click="selectLevel('Elementari')" class="w-full py-3 text-sm font-bold border border-petrol/20 rounded hover:bg-petrol hover:text-white transition-colors">
                                Mi interessa Elementari
                            </button>
                        </div>

                        <!-- MEDIE -->
                        <div class="bg-white p-8 rounded-xl shadow-sm border border-petrol/5 hover:border-coral/30 transition-all group flex flex-col">
                            <span class="text-xs font-bold tracking-widest text-petrol/40 mb-4">MEDIE</span>
                            <h3 class="font-serif text-2xl text-petrol mb-2 group-hover:text-coral transition-colors">Dal 'memoria' al 'capisco'</h3>
                            <p class="text-sm text-petrol/60 italic mb-6">"Fa fatica con testi lunghi e sintesi."</p>
                            <ul class="text-sm text-petrol/80 space-y-2 mb-8 flex-grow">
                                <li>• Materie umanistiche</li>
                                <li>• Metodo di studio autonomo</li>
                                <li>• Analisi e sintesi testi</li>
                            </ul>
                            <button @click="selectLevel('Medie')" class="w-full py-3 text-sm font-bold border border-petrol/20 rounded hover:bg-petrol hover:text-white transition-colors">
                                Mi interessa Medie
                            </button>
                        </div>

                        <!-- SUPERIORI -->
                        <div class="bg-white p-8 rounded-xl shadow-sm border border-petrol/5 hover:border-coral/30 transition-all group flex flex-col">
                            <span class="text-xs font-bold tracking-widest text-petrol/40 mb-4">SUPERIORI</span>
                            <h3 class="font-serif text-2xl text-petrol mb-2 group-hover:text-coral transition-colors">Maturità senza naufragare</h3>
                            <p class="text-sm text-petrol/60 italic mb-6">"Filosofia e Storia sono un ostacolo."</p>
                            <ul class="text-sm text-petrol/80 space-y-2 mb-8 flex-grow">
                                <li>• Ripetizioni Filosofia/Storia</li>
                                <li>• Preparazione esami/tesine</li>
                                <li>• Logica e argomentazione</li>
                            </ul>
                            <button @click="selectLevel('Superiori')" class="w-full py-3 text-sm font-bold border border-petrol/20 rounded hover:bg-petrol hover:text-white transition-colors">
                                Mi interessa Superiori
                            </button>
                        </div>

                        <!-- UNIVERSITÀ -->
                        <div class="bg-white p-8 rounded-xl shadow-sm border border-petrol/5 hover:border-coral/30 transition-all group flex flex-col">
                            <span class="text-xs font-bold tracking-widest text-petrol/40 mb-4">UNIVERSITÀ</span>
                            <h3 class="font-serif text-2xl text-petrol mb-2 group-hover:text-coral transition-colors">Esami e Tesi sbloccati</h3>
                            <p class="text-sm text-petrol/60 italic mb-6">"Bloccato sulla scrittura o concetti."</p>
                            <ul class="text-sm text-petrol/80 space-y-2 mb-8 flex-grow">
                                <li>• Esami Filosofia/Etica/Storia</li>
                                <li>• Supporto scrittura Tesi</li>
                                <li>• Approfondimento critico</li>
                            </ul>
                            <button @click="selectLevel('Università')" class="w-full py-3 text-sm font-bold border border-petrol/20 rounded hover:bg-petrol hover:text-white transition-colors">
                                Mi interessa Uni
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SEZIONE 7: CHECKLIST SESSIONE -->
            <section id="diagnosi-info" class="py-20 bg-surface border-t border-petrol/10 px-6">
                <div class="container mx-auto max-w-4xl text-center">
                    <h2 class="font-serif text-3xl md:text-5xl mb-12 text-petrol">
                        La prima sessione è gratuita,<br> ma non è una chiacchierata a caso.
                    </h2>
                    
                    <div class="grid md:grid-cols-2 gap-8 text-left max-w-3xl mx-auto mb-12">
                        <div class="flex gap-4">
                            <div class="w-10 h-10 rounded-full bg-coral/10 flex items-center justify-center text-coral shrink-0">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                            </div>
                            <div>
                                <h4 class="font-bold text-petrol">Analisi reale</h4>
                                <p class="text-petrol/70 text-sm">Guardiamo voti, tempi e difficoltà concrete.</p>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <div class="w-10 h-10 rounded-full bg-coral/10 flex items-center justify-center text-coral shrink-0">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>
                            </div>
                            <div>
                                <h4 class="font-bold text-petrol">Test sul campo</h4>
                                <p class="text-petrol/70 text-sm">Ti vedo affrontare un testo o un esercizio in diretta.</p>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <div class="w-10 h-10 rounded-full bg-coral/10 flex items-center justify-center text-coral shrink-0">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                            </div>
                            <div>
                                <h4 class="font-bold text-petrol">Intervento pratico</h4>
                                <p class="text-petrol/70 text-sm">Lavoriamo subito su un blocco specifico.</p>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <div class="w-10 h-10 rounded-full bg-coral/10 flex items-center justify-center text-coral shrink-0">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            </div>
                            <div>
                                <h4 class="font-bold text-petrol">Mini-piano</h4>
                                <p class="text-petrol/70 text-sm">Definiamo obiettivi realistici e durata del percorso.</p>
                            </div>
                        </div>
                    </div>
                    
                    <button @click="scrollToForm()" class="bg-coral text-white py-4 px-10 rounded-lg text-xl font-medium shadow-lg hover:bg-coralHover hover:-translate-y-1 transition-all">
                        Prenota la tua sessione gratuita
                    </button>
                </div>
            </section>

            <!-- SEZIONE 8: FORM FINALE -->
            <section id="diagnosi" class="py-24 px-6 bg-white">
                <div class="container mx-auto max-w-2xl">
                    <div class="text-center mb-10">
                        <h2 class="font-serif text-4xl text-petrol mb-4">Parlami del tuo caso in 60 secondi.</h2>
                        <p class="text-petrol/60">Alcuni campi sono già compilati in base alle tue risposte. Puoi aggiungere dettagli dove preferisci.</p>
                    </div>

                    <form class="space-y-6" @submit.prevent="submitForm">
                        <input type="hidden" name="ruolo" :value="role === 'genitore' ? 'Genitore' : 'Studente'">

                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-xs font-bold uppercase text-petrol/50 mb-1">Chi sei</label>
                                <input type="text" :value="role === 'genitore' ? 'Genitore' : 'Studente'" disabled class="w-full p-3 bg-cream border border-petrol/10 rounded text-petrol font-medium cursor-not-allowed">
                            </div>
                            
                            <div>
                                <label class="block text-xs font-bold uppercase text-petrol/50 mb-1">Livello Scolastico</label>
                                <select x-model="selectedLevel" name="livello" class="w-full p-3 bg-surface border border-petrol/20 rounded text-petrol focus:border-coral focus:ring-1 focus:ring-coral outline-none">
                                    <option value="">Seleziona livello...</option>
                                    <option value="Elementari">Elementari</option>
                                    <option value="Medie">Medie</option>
                                    <option value="Superiori">Superiori</option>
                                    <option value="Università">Università</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label class="block text-xs font-bold uppercase text-petrol/50 mb-1">Principali difficoltà</label>
                            <textarea rows="3" x-model="formProblems" name="difficolta" class="w-full p-3 bg-surface border border-petrol/20 rounded text-petrol focus:border-coral focus:ring-1 focus:ring-coral outline-none placeholder-petrol/30" placeholder="Es. Capire i testi, organizzare il tempo..."></textarea>
                            <p class="text-xs text-petrol/40 mt-1 text-right">
                                Testo suggerito dalle tue scelte. Se vuoi, aggiungi materia, classe/anno ed esempi concreti delle difficoltà.
                            </p>
                        </div>

                        <div>
                            <label class="block text-xs font-bold uppercase text-petrol/50 mb-1">Obiettivo principale</label>
                            <input type="text" x-model="formGoal" name="obiettivo" class="w-full p-3 bg-surface border border-petrol/20 rounded text-petrol focus:border-coral focus:ring-1 focus:ring-coral outline-none" placeholder="Es. Voti più stabili, preparare la maturità, concludere la tesi...">
                        </div>

                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-xs font-bold uppercase text-petrol/50 mb-1">Nome</label>
                                <input type="text" name="nome" required class="w-full p-3 bg-surface border border-petrol/20 rounded text-petrol focus:border-coral focus:ring-1 focus:ring-coral outline-none">
                            </div>
                            <div>
                                <label class="block text-xs font-bold uppercase text-petrol/50 mb-1">Email o Telefono</label>
                                <input type="text" name="contatto" required class="w-full p-3 bg-surface border border-petrol/20 rounded text-petrol focus:border-coral focus:ring-1 focus:ring-coral outline-none">
                            </div>
                        </div>

                        <button type="submit" class="w-full bg-petrol text-white py-4 rounded-lg font-medium text-lg hover:bg-petrol/90 transition-all shadow-lg mt-4">
                            Invia richiesta di sessione
                        </button>
                    </form>

                    <div class="mt-12 text-center pt-10 border-t border-petrol/10">
                        <p class="mb-4 text-petrol/70">Preferisci scrivermi direttamente?</p>
                        <a :href="whatsappLink" target="_blank" class="inline-flex items-center gap-2 text-green-600 font-bold hover:underline text-lg">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.463 1.065 2.876 1.213 3.074.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/></svg>
                            Scrivimi su WhatsApp
                        </a>
                    </div>
                </div>
            </section>
        </div>
        
        <!-- STICKY CTA -->
        <div x-show="showStickyCTA && role" 
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 translate-y-20"
             x-transition:enter-end="opacity-100 translate-y-0"
             class="fixed bottom-6 right-6 z-40 flex flex-col items-end">
            
            <div x-show="selectedBlocks.length > 0" class="bg-petrol text-white text-xs py-1 px-3 rounded-t-lg mb-0 shadow-lg w-fit max-w-[220px] truncate">
                Focus: <span x-text="getStickySummary()"></span>
            </div>

            <button @click="scrollToForm()" class="bg-coral hover:bg-coralHover text-white font-bold py-3 px-6 rounded-l-xl rounded-br-xl shadow-2xl flex items-center gap-3 transition-all hover:scale-105">
                <span>Prenota una sessione</span>
                <span class="text-xs font-normal opacity-80 block" x-text="role === 'genitore' ? 'per tuo figlio' : 'per il tuo studio'"></span>
            </button>
        </div>

    </main>

    <!-- FOOTER -->
    <footer class="bg-petrol text-cream/60 py-12 px-6 text-center text-sm">
        <p class="font-serif text-xl text-cream mb-4">Dolores Lullo</p>
        <p>© 2025 - Metodo di Studio e Consulenza Filosofica.</p>
    </footer>

    <!-- ALPINE LOGIC -->
    <script>
        function studyMethodApp() {
            return {
                role: null,
                selectedBlocks: [],
                selectedAttempts: [],
                selectedGoals: [],
                selectedLevel: '',
                showStickyCTA: false,
                formProblems: '',
                formGoal: '',

                blocksOptions: [
                    { id: 'capire', label: 'Capire i testi complessi' },
                    { id: 'organizzare', label: 'Organizzare tempo e compiti' },
                    { id: 'verifiche', label: 'Preparare verifiche ed esami' },
                    { id: 'scrivere', label: 'Scrivere (temi, tesi, tesine)' }
                ],

                // 15 combinazioni blocchi
                blocksCombos: {
                    'capire': {
                        title: 'Difficoltà di comprensione dei testi',
                        symptomsParent: [
                            'Legge il testo ma non riesce a raccontarlo con parole sue.',
                            'Si ferma spesso, perde il filo e si concentra su dettagli irrilevanti.',
                            'Ha bisogno che qualcuno gli rispieghi tutto a voce per capire davvero.'
                        ],
                        symptomsStudent: [
                            'Leggi il testo ma fai fatica a spiegare con parole tue cosa hai letto.',
                            'Ti fermi spesso, perdi il filo e ti incastri sui dettagli meno importanti.',
                            'Hai bisogno che qualcuno ti rispieghi tutto a voce per sentirti sicuro di aver capito.'
                        ]
                    },
                    'organizzare': {
                        title: "Caos nell'organizzazione dello studio",
                        symptomsParent: [
                            'Rimanda spesso i compiti e finisce per studiare all’ultimo momento.',
                            'Non sa da dove iniziare: apre il diario, si perde e si blocca.',
                            'Passa molto tempo “sui libri” ma con poco risultato concreto.'
                        ],
                        symptomsStudent: [
                            'Rimandi spesso e ti ritrovi a studiare tutto all’ultimo minuto.',
                            'Apri il diario o la piattaforma e non sai da dove iniziare davvero.',
                            'Passi tanto tempo a “stare sui libri” ma alla fine ricordi poco e ti senti inconcludente.'
                        ]
                    },
                    'verifiche': {
                        title: 'Preparazione superficiale e ansia da verifica',
                        symptomsParent: [
                            'A casa sembra preparato, ma in verifica o all’interrogazione si blocca.',
                            'Studia tanto, ma in modo disordinato: ripassa senza una strategia chiara.',
                            'Prima delle verifiche aumenta l’ansia e a volte chiede di non andare a scuola.'
                        ],
                        symptomsStudent: [
                            'A casa ti sembra di sapere, ma davanti al prof o al compito ti si svuota la testa.',
                            'Studi tanto, ma ripassi in modo casuale, senza una strategia precisa.',
                            'Prima delle verifiche senti salire l’ansia e faresti volentieri a meno di presentarti.'
                        ]
                    },
                    'scrivere': {
                        title: 'Blocchi nella scrittura e confusione nelle idee',
                        symptomsParent: [
                            'Davanti al foglio si blocca e non sa come iniziare.',
                            'Quando scrive, le frasi sono lunghe, confuse e difficili da seguire.',
                            'Fa fatica a organizzare le idee in un discorso con inizio, sviluppo e conclusione.'
                        ],
                        symptomsStudent: [
                            'Davanti al foglio ti blocchi e non sai da dove cominciare.',
                            'Quando scrivi, le frasi diventano lunghe, contorte e poco chiare.',
                            'Fai fatica a mettere in ordine le idee e costruire un discorso che abbia un filo logico.'
                        ]
                    },
                    'capire_organizzare': {
                        title: 'Studia tanto, capisce poco e si perde nel caos',
                        symptomsParent: [
                            'Fa fatica a capire i testi e questo lo porta a rallentare su tutto il resto.',
                            'Perde tempo su poche pagine, poi si accorge di essere indietro con il resto dei compiti.',
                            'Alterna momenti di iper-sforzo a momenti di blocco totale, senza un piano che lo aiuti.'
                        ],
                        symptomsStudent: [
                            'Fai fatica a capire ciò che leggi e questo ti fa rallentare su tutto.',
                            'Resti bloccato su poche pagine e poi ti accorgi che hai lasciato indietro il resto.',
                            'Alterni giornate in cui ti sforzi tantissimo ad altre in cui ti blocchi, perché non hai un piano chiaro.'
                        ]
                    },
                    'capire_verifiche': {
                        title: 'Studia tanto ma in verifica non regge il livello dei testi',
                        symptomsParent: [
                            'I testi del libro o delle fotocopie sono troppo densi: li legge ma non li domina.',
                            'In verifica o all’interrogazione, quando le domande partono dal testo, si confonde facilmente.',
                            "Ha l’impressione di non essere all’altezza di quel livello di difficoltà, anche se si impegna."
                        ],
                        symptomsStudent: [
                            'I testi che devi studiare ti sembrano troppo densi: li leggi ma non ci prendi veramente confidenza.',
                            'In verifica o all’orale, quando le domande partono dal testo, ti confondi e non sai dove agganciarti.',
                            'Hai la sensazione di non essere al livello giusto, anche se ti impegni un sacco.'
                        ]
                    },
                    'capire_scrivere': {
                        title: 'Capisce pezzi sparsi ma non riesce a trasformarli in un testo chiaro',
                        symptomsParent: [
                            'Coglie alcune parti del testo ma non riesce a costruire un discorso coerente.',
                            'Quando deve scrivere, mette insieme frasi scollegate, come se mancasse il filo centrale.',
                            'Fa fatica a passare dalla lettura alla scrittura: ciò che ha capito non si traduce in un elaborato solido.'
                        ],
                        symptomsStudent: [
                            'Capisci pezzi del testo, ma ti sfugge l’idea centrale da cui partire.',
                            'Quando inizi a scrivere, le frasi risultano scollegate e non rendono davvero ciò che hai capito.',
                            'Ti sembra di avere le informazioni in testa, ma non riesci a trasformarle in un testo chiaro e strutturato.'
                        ]
                    },
                    'organizzare_verifiche': {
                        title: 'Studio a singhiozzo e verifiche vissute come emergenze',
                        symptomsParent: [
                            'Non pianifica lo studio: si muove solo quando arriva la verifica.',
                            'Accuma pagine e materie, poi prova a recuperare tutto in pochissimo tempo.',
                            'Arriva agli esami stanco, agitato e con la sensazione di non aver studiato in modo serio.'
                        ],
                        symptomsStudent: [
                            'Non programmi lo studio: ti muovi solo quando vedi una verifica avvicinarsi.',
                            'Accumi argomenti e poi cerchi di recuperarli tutti insieme all’ultimo momento.',
                            'Arrivi agli esami stanco, agitato e con la sensazione di non aver costruito basi solide.'
                        ]
                    },
                    'organizzare_scrivere': {
                        title: 'Scrittura sempre rimandata e gestita all’ultimo',
                        symptomsParent: [
                            'Rimanda i compiti di scrittura fino all’ultimo, poi si stressa per consegnare in tempo.',
                            'Non spezza il lavoro in fasi (idee, scaletta, bozza): cerca di fare tutto in una volta sola.',
                            "Il risultato è un testo confuso, con correzioni dell’ultimo minuto e poca revisione vera."
                        ],
                        symptomsStudent: [
                            'Rimandi i temi, le tesine o la tesi finché non sei costretto a metterci mano.',
                            'Cerchi di fare tutto in un’unica sessione: pensare, scrivere e correggere insieme.',
                            'Quello che consegni spesso non rispecchia quanto vali davvero, perché il processo è confuso e affrettato.'
                        ]
                    },
                    'verifiche_scrivere': {
                        title: 'Sa le cose “a voce”, ma si blocca quando deve metterle per iscritto',
                        symptomsParent: [
                            'Quando ripassa oralmente sembra preparato, ma appena deve scrivere va in difficoltà.',
                            'In verifica scritta non riesce a esprimere la stessa chiarezza che mostra parlando.',
                            'Spesso prende voti più bassi nelle prove scritte rispetto alle interrogazioni.'
                        ],
                        symptomsStudent: [
                            'Quando ripassi a voce ti sembra di sapere, ma appena devi scrivere ti blocchi.',
                            'Nei compiti scritti non riesci a esprimere con la stessa chiarezza quello che diresti parlando.',
                            'I voti delle prove scritte sono spesso più bassi rispetto alle interrogazioni orali.'
                        ]
                    },
                    'capire_organizzare_verifiche': {
                        title: 'Studia tanto ma resta indietro e arriva alla verifica senza sicurezza',
                        symptomsParent: [
                            'Fa fatica a capire i testi, perciò ci mette molto più tempo degli altri a studiare.',
                            'Non avendo un piano, si ritrova spesso indietro con il programma rispetto alle verifiche.',
                            'Arriva agli esami con la sensazione di aver corso dietro alle scadenze, senza aver consolidato davvero ciò che serve.'
                        ],
                        symptomsStudent: [
                            'Fai fatica a capire bene i testi, quindi ti serve molto più tempo per studiare.',
                            'Senza un piano chiaro, ti accorgi vicino alla verifica di avere ancora tanto arretrato.',
                            'Arrivi alla prova sentendoti in affanno, come se stessi inseguendo il programma invece di dominarlo.'
                        ]
                    },
                    'capire_organizzare_scrivere': {
                        title: 'Idee confuse, tempo sprecato e testi che non rendono il tuo reale livello',
                        symptomsParent: [
                            'Impiega molto tempo per capire il materiale di studio e questo rallenta tutto il resto.',
                            'Non organizza il lavoro di scrittura in fasi e finisce per improvvisare all’ultimo.',
                            'I testi consegnati non riflettono il suo vero potenziale, perché arrivano da un processo caotico.'
                        ],
                        symptomsStudent: [
                            'Ti serve molto tempo per capire bene i testi, quindi parti già in ritardo.',
                            'Non organizzi il lavoro di scrittura in passi chiari: ti ritrovi a improvvisare.',
                            'Quello che consegni spesso non rispecchia quanto vali davvero, perché il processo è confuso e affrettato.'
                        ]
                    },
                    'capire_verifiche_scrivere': {
                        title: 'Fatica a capire, paura delle verifiche e blocco davanti al foglio',
                        symptomsParent: [
                            'I testi risultano pesanti, e questo rende lo studio lento e faticoso.',
                            'Le verifiche lo mettono in ansia perché non si sente mai davvero pronto sui contenuti.',
                            'Quando deve scrivere, il blocco aumenta: teme di non riuscire a mettere in ordine ciò che ha capito.'
                        ],
                        symptomsStudent: [
                            'I testi ti sembrano pesanti, pieni di concetti che non si lasciano afferrare facilmente.',
                            'Le verifiche ti mettono in agitazione perché non ti senti mai davvero solido sugli argomenti.',
                            'Davanti al foglio la pressione aumenta: temi di non riuscire a mettere in ordine tutto ciò che hai in testa.'
                        ]
                    },
                    'organizzare_verifiche_scrivere': {
                        title: 'Vivi lo studio come una corsa continua contro il tempo',
                        symptomsParent: [
                            'Non pianifica: si attiva solo quando le verifiche si avvicinano.',
                            'In quei momenti deve anche scrivere temi, relazioni o tesine, e il carico esplode.',
                            "L’insieme di scadenze, compiti scritti e poca organizzazione crea stress continuo a casa."
                        ],
                        symptomsStudent: [
                            'Non hai una routine: ti muovi solo quando vedi le scadenze in faccia.',
                            'Devi preparare verifiche e allo stesso tempo scrivere temi, relazioni o capitoli di tesi.',
                            'Ti sembra di essere sempre in rincorsa, con la sensazione di avere troppa roba e troppo poco tempo.'
                        ]
                    },
                    'capire_organizzare_verifiche_scrivere': {
                        title: 'Sistema di studio frammentato: tanta fatica, poca resa',
                        symptomsParent: [
                            'Fatìca a capire i testi, quindi ha bisogno di più tempo di quanto ne abbia davvero.',
                            'Non avendo un metodo, si ritrova sempre in affanno tra compiti, verifiche e scadenze scritte.',
                            'Ogni verifica o compito scritto diventa una piccola emergenza, e lo studio non costruisce basi solide nel tempo.'
                        ],
                        symptomsStudent: [
                            'Ti sembra che ogni testo sia una salita ripida, e questo ti ruba tempo e energie.',
                            'Senza un metodo chiaro, ti ritrovi a rincorrere compiti, verifiche e testi da scrivere.',
                            'Ogni prova diventa un’emergenza, e hai la sensazione di faticare tantissimo senza costruire davvero fondamenta stabili.'
                        ]
                    }
                },

                attemptsOptions: [
                    { code: 'R', label: 'Ripetizioni generiche' },
                    { code: 'S', label: 'Studiare più ore' },
                    { code: 'H', label: 'Schemi fai-da-te' },
                    { code: 'N', label: 'Nulla, improvviso' }
                ],

                attemptsCombos: {
                    'R': {
                        title: 'Le ripetizioni non hanno cambiato il quadro',
                        textParent: 'Avete già fatto ripetizioni, ma il problema si ripresenta ogni volta che cambia argomento o insegnante. Tuo figlio ascolta, sembra capire, ma da solo fa fatica a replicare il lavoro e a organizzarsi. Il risultato è che dipende sempre da qualcuno che “gli rispieghi” invece di sviluppare un metodo tutto suo.',
                        textStudent: 'Hai già fatto ripetizioni, ma appena finisce la lezione torni a sentirti punto e a capo. Capisci mentre qualcuno ti spiega, ma da solo fai fatica a riorganizzare il lavoro e ad andare avanti. Alla fine ti ritrovi dipendente da qualcuno che ti “rimetta in riga” ogni volta, invece di avere un metodo tuo.'
                    },
                    'S': {
                        title: 'Aumentare le ore non sta aumentando i risultati',
                        textParent: 'Avete provato a farlo studiare di più, ma più tempo passa sui libri, più sembra stanco e scoraggiato. Le ore aumentano, i voti migliorano poco o in modo altalenante, e a casa si respira frustrazione. Lo sforzo è alto, ma manca una struttura che renda quel tempo davvero efficace.',
                        textStudent: 'Hai provato a studiare di più, ma più tempo resti sui libri, più ti senti stanco e svuotato. Le ore aumentano, i risultati migliorano poco o restano instabili, e ti chiedi se ne valga la pena. Stai usando tanta energia, ma senza un metodo chiaro il rendimento non cresce davvero.'
                    },
                    'H': {
                        title: 'Schemi ovunque, ma poca chiarezza in testa',
                        textParent: 'Ha provato a fare schemi e riassunti, ma spesso sono solo copie abbreviate del libro. Passa molto tempo a “sistemare gli appunti”, ma poi in verifica fa fatica a ritrovare le idee centrali. Gli schemi non diventano uno strumento per pensare, restano un’altra forma di riscrittura.',
                        textStudent: 'Hai provato a fare schemi, mappe e riassunti, ma spesso sono solo il libro riscritto in piccolo. Passi un sacco di tempo a sistemare appunti e colori, ma quando devi usare quelle informazioni ti perdi. Gli schemi non ti guidano nel ragionamento: sono solo un altro modo di riscrivere, non di capire.'
                    },
                    'N': {
                        title: 'Finora vi siete arrangiati, ma il nodo è venuto al pettine',
                        textParent: 'Finora avete improvvisato: si studia quando serve, come si riesce, senza una vera strategia. Ogni verifica viene gestita come un’emergenza, e a casa regna l’idea di “ce la caviamo all’ultimo”. Questo crea tensione e rende difficile costruire sicurezza e continuità nei risultati.',
                        textStudent: 'Finora hai improvvisato: studi quando serve, come capita, senza un vero piano. Ogni verifica diventa una corsa all’ultimo minuto e ti affidi alla memoria o alla fortuna. È normale che così tu ti senta sempre in affanno e mai davvero solido su quello che stai facendo.'
                    },
                    'R_S': {
                        title: 'Tanta fatica, ma il salto di qualità non arriva',
                        textParent: 'Avete già provato sia le ripetizioni sia ad aumentare le ore di studio, ma il salto di qualità non c’è stato. Tuo figlio si impegna, ma sembra girare in tondo: più spiegazioni, più ore, stessi blocchi di fondo. Il problema non è la quantità di aiuto o di tempo, è l’assenza di un metodo chiaro che lo renda autonomo.',
                        textStudent: 'Hai fatto ripetizioni e hai provato a studiare di più, ma la sensazione è di girare in tondo. Ricevi spiegazioni, passi ore sui libri, ma in verifica tornano gli stessi blocchi di prima. Non è una questione di “impegnarti di più”: ti manca una struttura che ti faccia usare bene l’energia che stai già mettendo.'
                    },
                    'R_H': {
                        title: 'Ti spiegano la lezione, ma il metodo non decolla',
                        textParent: 'Le ripetizioni lo aiutano sul momento e gli schemi gli danno l’idea di essere organizzato, ma i risultati durano poco. Appena cambia argomento o insegnante, servono nuove spiegazioni e nuovi schemi da capo. Non si sta costruendo un modo di studiare trasferibile, solo “pezze” temporanee sui singoli capitoli.',
                        textStudent: 'Le ripetizioni ti sbloccano sul momento e gli schemi ti fanno sentire più ordinato, ma l’effetto dura poco. Quando cambi argomento ti ritrovi di nuovo a chiedere aiuto e a rifare schemi da zero. Non stai ancora costruendo un metodo che puoi riusare ovunque: stai solo rincorrendo ogni capitolo separatamente.'
                    },
                    'S_H': {
                        title: 'Molto lavoro di forma, poca resa in profondità',
                        textParent: 'Sta studiando di più e facendo schemi, ma sembra investire tantissimo tempo in organizzazione e poco in comprensione reale. Le giornate si riempiono di studio, ma davanti alle verifiche emerge ancora insicurezza. La forma del lavoro è più curata, ma il cuore del problema – capire, scegliere cosa è importante – resta scoperto.',
                        textStudent: 'Stai studiando di più e passi tempo a fare schemi, evidenziare, sistemare appunti. Alla fine però ti ritrovi ancora insicuro, soprattutto quando devi rispondere a domande che vanno oltre il “ripetere”. Stai lavorando tanto sulla forma dello studio, ma ti manca un metodo che ti aiuti a capire davvero e a selezionare ciò che conta.'
                    },
                    'R_S_H': {
                        title: 'Stai usando tutti gli strumenti, ma manca la regia',
                        textParent: 'Avete provato ripetizioni, più ore di studio e schemi: in pratica state usando tutti gli strumenti possibili. Nonostante questo, tuo figlio sembra ancora in affanno e i risultati non sono stabili. Manca una regia: un modo per mettere ordine tra spiegazioni, tempo e materiali, trasformandoli in un metodo che lo renda indipendente.',
                        textStudent: 'Hai fatto ripetizioni, studi di più, fai schemi: in pratica stai usando tutte le leve che conosci. Eppure ti senti ancora sotto pressione e i risultati non sono solidi come vorresti. Quello che manca non è “fare di più”, ma avere un metodo che metta in ordine tutto questo lavoro e lo renda finalmente tuo.'
                    }
                },

                goalsOptions: [
                    { id: 'autonomia', label: 'Più autonomia', promise: 'Che sappia organizzarsi senza bisogno di controllo continuo.' },
                    { id: 'ansia', label: 'Meno ansia', promise: 'Affrontare le prove con la sicurezza di chi sa.' },
                    { id: 'voti', label: 'Voti stabili', promise: 'Niente più montagne russe: risultati costanti.' },
                    { id: 'esposizione', label: 'Saper spiegare', promise: 'Esporre concetti complessi con parole semplici.' }
                ],

                init() {
                    window.addEventListener('scroll', () => {
                        this.showStickyCTA = window.scrollY > 600;
                    });
                },

                setRole(r) {
                    this.role = r;
                    setTimeout(() => {
                        document.getElementById('step-blocks').scrollIntoView({ behavior: 'smooth' });
                    }, 300);
                },

                toggleSelection(type, value) {
                    if (type === 'blocks') {
                        this.toggleFromArray('selectedBlocks', value);
                    } else if (type === 'attempts') {
                        this.toggleAttempts(value);
                    } else if (type === 'goals') {
                        this.toggleFromArray('selectedGoals', value);
                    }
                    this.updateFormFields();
                },

                toggleFromArray(field, value) {
                    const arr = this[field];
                    const idx = arr.indexOf(value);
                    if (idx > -1) {
                        arr.splice(idx, 1);
                    } else {
                        arr.push(value);
                    }
                },

                toggleAttempts(code) {
                    const arr = this.selectedAttempts;
                    const isNulla = code === 'N';

                    if (isNulla) {
                        this.selectedAttempts = ['N'];
                        return;
                    }

                    const nullaIndex = arr.indexOf('N');
                    if (nullaIndex > -1) {
                        arr.splice(nullaIndex, 1);
                    }

                    const idx = arr.indexOf(code);
                    if (idx > -1) {
                        arr.splice(idx, 1);
                    } else {
                        arr.push(code);
                    }
                },

                getBlocksKey() {
                    if (!this.selectedBlocks.length) return null;
                    return this.selectedBlocks.slice().sort().join('_');
                },

                getBlocksInfo() {
                    const key = this.getBlocksKey();
                    if (!key) return null;
                    return this.blocksCombos[key] || null;
                },

                getBlocksSymptoms() {
                    const info = this.getBlocksInfo();
                    if (!info) return [];
                    const isParent = this.role === 'genitore';
                    return isParent ? info.symptomsParent : info.symptomsStudent;
                },

                getInterventionText() {
                    if (!this.selectedBlocks.length) return '';
                    const isParent = this.role === 'genitore';
                    const labels = this.selectedBlocks
                        .map(id => this.blocksOptions.find(o => o.id === id)?.label.toLowerCase())
                        .filter(Boolean)
                        .join(', ');
                    if (isParent) {
                        return `Lavoriamo insieme su ${labels} con un metodo strutturato: ti mostro come trasformare il modo in cui tuo figlio studia, invece di aggiungere solo altre ore sui libri.`;
                    } else {
                        return `Lavoriamo insieme su ${labels} con un metodo chiaro: ti aiuto a cambiare il modo in cui studi, non solo ad aggiungere altre ore sui libri.`;
                    }
                },

                getAttemptsKey() {
                    if (!this.selectedAttempts.length) return null;
                    const sorted = this.selectedAttempts.slice().sort();
                    return sorted.join('_');
                },

                getAttemptsInfo() {
                    const key = this.getAttemptsKey();
                    if (!key) return null;
                    return this.attemptsCombos[key] || null;
                },

                getAttemptsText() {
                    const info = this.getAttemptsInfo();
                    if (!info) return '';
                    return this.role === 'genitore' ? info.textParent : info.textStudent;
                },

                getStickySummary() {
                    if (!this.selectedBlocks.length) return '...';
                    const labels = this.selectedBlocks
                        .map(id => this.blocksOptions.find(o => o.id === id)?.label)
                        .filter(Boolean);
                    const text = labels.join(', ');
                    return text.length > 25 ? text.substring(0, 25) + '…' : text;
                },

                selectLevel(level) {
                    this.selectedLevel = level;
                    const s = document.getElementById('diagnosi-info');
                    if (s) s.scrollIntoView({ behavior: 'smooth' });
                },

                updateFormFields() {
                    const problemsTextBase = this.selectedBlocks
                        .map(id => this.blocksOptions.find(o => o.id === id)?.label)
                        .filter(Boolean)
                        .join(', ');

                    if (problemsTextBase) {
                        this.formProblems = problemsTextBase + '. Se vuoi, aggiungi materia, classe/anno ed esempi concreti delle difficoltà.';
                    } else {
                        this.formProblems = '';
                    }

                    if (this.selectedGoals.length > 0) {
                        const firstGoal = this.goalsOptions.find(g => g.id === this.selectedGoals[0]);
                        this.formGoal = firstGoal ? firstGoal.label : '';
                    } else {
                        this.formGoal = '';
                    }
                },

                scrollToForm() {
                    const el = document.getElementById('diagnosi');
                    if (el) el.scrollIntoView({ behavior: 'smooth' });
                },

                get whatsappLink() {
                    const phone = '39XXXXXXXXXX'; // Sostituire con numero reale
                    let text = `Ciao Dolores, sono un ${this.role || 'interessato'}`;
                    if (this.selectedLevel) text += ` (Livello: ${this.selectedLevel})`;
                    if (this.formProblems) text += `. Ho difficoltà su: ${this.formProblems}`;
                    text += '. Vorrei prenotare una sessione gratuita.';
                    return `https://wa.me/${phone}?text=${encodeURIComponent(text)}`;
                },
                
                submitForm() {
                    if (!this.role) {
                        alert("Per favore indica se sei genitore o studente all'inizio della pagina.");
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        return;
                    }
                    if (!this.formProblems || !this.formProblems.trim()) {
                        alert('Per favore descrivi brevemente le difficoltà principali prima di inviare.');
                        return;
                    }
                    window.open(this.whatsappLink, '_blank');
                }
            }
        }
    </script>
</body>
</html>
